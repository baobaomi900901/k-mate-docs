---
title: 粘贴Excel内容
order: 3
---

# 粘贴Excel内容

## 功能说明

:::tip 功能描述
粘贴Excel内容
:::

![粘贴Excel内容](../../../../assets/粘贴Excel内容_command.png)

## 配置项说明

### 常规

**指令输入**

- **Excel对象**`TWorkbookApplication`: 输入一个通过函数'打开或新建Excel'/'获取当前激活的Excel对象'存储的Excel对象

- **单元行号**`Integer`: 粘贴内容的单元格行号。从1开始，-n表示倒数第n行

- **单元列名**`string`: 粘贴内容的单元格列名(支持A或1)，-n表示倒数第n列

- **选择性粘贴**`Integer`: 选择性粘贴，包括：

    - 全部：包括内容、和格式等。当你想粘贴所有内容而不做任何过滤时，选择“所有”。

    - 公式：只粘贴源单元格中的公式，不包含格式或数值。如果你希望复制公式，而不复制公式结果的数值，可以使用“公式”。

    - 数值：只粘贴源单元格中的数值，忽略公式和格式。如果源单元格中包含公式而你只想保留计算结果（而非公式本身），使用“数值”。

    - 格式：只粘贴源单元格的格式（字体、颜色、边框等），而不复制数据内容。当你希望将格式应用到不同的单元格中，但不需要原始内容时，选择“格式”。

    - 批注：仅粘贴源单元格中的注释或批注内容。当你只想复制单元格的批注，而不涉及数据或格式时，选择此项。

    - 有效性验证：仅粘贴源单元格的数据验证规则（如数据有效性、下拉列表等）。当你希望将一个单元格的验证规则应用到其他单元格时，选择此项。

    - 所有使用源主题的单元：粘贴源单元格的内容，并且保持源单元格的格式、颜色和字体主题。如果你想粘贴内容，并且保留源单元格的主题和格式，可以使用此选项。

    - 边框除外：粘贴除边框外的所有内容和格式。

    - 列宽：仅粘贴源单元格的列宽设置，而不粘贴内容。当你只想复制列宽，而不复制其他数据内容时，可以使用此选项。

    - 公式和数字格式：粘贴公式和数字格式（如货币、日期等），但不包括数值或其他格式。当你只需要公式并且希望保留它们的数字格式时，可以选择此选项。

    - 值和数字格式：粘贴数值和数字格式（如货币、日期等），但不包括公式或其他格式。当你只需要数值并且希望保留它们的数字格式时，可以选择此选项。

    - 所有合并条件格式：仅粘贴复制单元中的内容和条件格式选项

- **粘贴运算**`Integer`: 选择性粘贴运算，包括

    - 无：源区域不参与运算，按所选择的粘贴方式粘贴

    - 加：把源区域内的值，与目标区域相加，得到相加后的结果

    - 减：把源区域内的值，与目标区域相减，得到相减后的结果

    - 乘：把源区域内的值，与目标区域相乘，得到相加乘的结果

    - 除：把目标区域内的值除以源区域的值，得到相除后的结果。若源区域是0，则结果显示#DIV/0!错误

- **跳过空单元格**`Boolean`: 当复制区域中出现空白单元格时，避免替换粘贴区域中的值

- **转置**`Boolean`: 行列转置。把复制区域的列更改为行或行更改为列

- **Sheet页名称**`string`: 为空则默认为当前激活的Sheet页


**指令输出**

当前指令无输出

### 高级

- **执行前的延迟(毫秒)**`Integer`: 指令执行前的等待时间

### 错误处理

- **打印错误日志**`Boolean`：当指令运行出错时，打印错误日志到【日志】面板。默认勾选。

- **处理方式**`Integer`：

    - **终止流程**：指令运行出错时，终止流程。

    - **忽略异常并继续执行**：指令运行出错时，忽略异常，继续执行流程。

    - **重试此指令**：指令运行出错时，重试运行指定次数指令，每次重试间隔指定时长。

## 使用示例
无

## 常见错误及处理

无

## 常见问题解答

无

